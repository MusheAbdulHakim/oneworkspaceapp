name: Connect to Server

on: [push]  # Runs on push events (can be customized for other events)

jobs:
  connect:
    runs-on: ubuntu-latest  # Workflow runs on Ubuntu runner

    steps:
      - name: Configure SSH  # Add SSH key and configuration
        run: |
          mkdir -p ~/.ssh  # Create SSH directory if it doesn't exist
          echo "$SSH_PRIVATE_KEY" > ~/.ssh/id_rsa  # Add private key from secret
          chmod 600 ~/.ssh/id_rsa  # Set permissions on key
          cat >>~/.ssh/config <<EOF  # Configure SSH config
          Host ${{ secrets.HOST }}
            HostName ${{ secrets.HOST }}
            User ${{ secrets.USER }}
            IdentityFile ~/.ssh/id_rsa
            StrictHostKeyChecking no
          EOF
        env:
          SSH_PRIVATE_KEY: ${{ secrets.SSH_PRIVATE_KEY }}  # Reference secret containing private key
          HOST: ${{ secrets.HOST }}  # Reference secret with server hostname
          USER: ${{ secrets.USER }}  # Reference secret with server username

      - name: Run Linux Commands  # Execute commands on server
        run: |
            ssh ${{ secrets.HOST }}  # Connect to server
            << 'commands'  # Here-string for multi-line commands
            # Your actual Linux commands here (e.g., uptime, ls -l /var/www)
            uptime
            ls -l /var/www
            commands

